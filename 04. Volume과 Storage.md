
# Volumeê³¼ Storage

## ğŸ“¦ ë°ì´í„° ì €ì¥ì´ ì™œ ì¤‘ìš”í•œê°€?

### ğŸ  ì´ì‚¬ ë¹„ìœ 
```
ğŸ  ì»¨í…Œì´ë„ˆ = ì„ëŒ€ ì•„íŒŒíŠ¸
ğŸ“¦ ë°ì´í„° = ë‚´ ì†Œì¤‘í•œ ë¬¼ê±´ë“¤
ğŸ—‘ï¸ ì»¨í…Œì´ë„ˆ ì‚­ì œ = ì•„íŒŒíŠ¸ ê³„ì•½ ë§Œë£Œ

ë¬¸ì œ: ì•„íŒŒíŠ¸ë¥¼ ë– ë‚  ë•Œ ë‚´ ë¬¼ê±´ë„ í•¨ê»˜ ì‚¬ë¼ì§! ğŸ˜±
í•´ê²°: ì°½ê³ (Volume)ì— ì¤‘ìš”í•œ ë¬¼ê±´ë“¤ì„ ë”°ë¡œ ë³´ê´€ ğŸ“¦
```

### ğŸ’¾ ì»¨í…Œì´ë„ˆì˜ ë°ì´í„° ë¬¸ì œì 
```
âŒ ì»¨í…Œì´ë„ˆê°€ ì‚­ì œë˜ë©´ ë°ì´í„°ë„ í•¨ê»˜ ì‚­ì œ
âŒ ì»¨í…Œì´ë„ˆ ê°„ ë°ì´í„° ê³µìœ  ì–´ë ¤ì›€
âŒ í˜¸ìŠ¤íŠ¸ì—ì„œ ë°ì´í„° ì§ì ‘ ì ‘ê·¼ ë¶ˆê°€
âŒ ë°±ì—…ê³¼ ë³µì›ì´ ë³µì¡í•¨

âœ… Volume ì‚¬ìš©í•˜ë©´ ëª¨ë“  ë¬¸ì œ í•´ê²°!
```

## Docker Storage ì¢…ë¥˜

### ğŸ“Š ì €ì¥ ë°©ì‹ ë¹„êµ
| êµ¬ë¶„ | Volume | Bind Mount | tmpfs |
|------|--------|------------|-------|
| **ê´€ë¦¬ ì£¼ì²´** | Docker | ì‚¬ìš©ì | ë©”ëª¨ë¦¬ |
| **ê²½ë¡œ** | Docker ê´€ë¦¬ | í˜¸ìŠ¤íŠ¸ ì ˆëŒ€ê²½ë¡œ | ë©”ëª¨ë¦¬ |
| **ì„±ëŠ¥** | ìµœê³  | ì¢‹ìŒ | ìµœê³  |
| **ê³µìœ ** | ì‰¬ì›€ | ê°€ëŠ¥ | ë¶ˆê°€ |
| **ë°±ì—…** | ì‰¬ì›€ | ìˆ˜ë™ | ë¶ˆê°€ |
| **ì‚¬ìš© ì˜ˆì‹œ** | DB ë°ì´í„° | ê°œë°œ ì†ŒìŠ¤ | ì„ì‹œ íŒŒì¼ |

### ğŸ¯ ê°ê°ì˜ íŠ¹ì§•

#### ğŸ“¦ Volume (ê¶Œì¥)
```
âœ… Dockerê°€ ì™„ì „íˆ ê´€ë¦¬
âœ… ì»¨í…Œì´ë„ˆì™€ ë…ë¦½ì ìœ¼ë¡œ ì¡´ì¬
âœ… ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆ ê°„ ê³µìœ  ê°€ëŠ¥
âœ… ë°±ì—…ê³¼ ë³µì›ì´ ì‰¬ì›€
âœ… í¬ë¡œìŠ¤ í”Œë«í¼ í˜¸í™˜
```

#### ğŸ”— Bind Mount
```
âœ… í˜¸ìŠ¤íŠ¸ íŒŒì¼ì‹œìŠ¤í…œ ì§ì ‘ ì ‘ê·¼
âœ… ê°œë°œ ì‹œ ì‹¤ì‹œê°„ ì½”ë“œ ë³€ê²½ ë°˜ì˜
âš ï¸ í˜¸ìŠ¤íŠ¸ ê²½ë¡œì— ì˜ì¡´ì 
âš ï¸ ë³´ì•ˆ ìœ„í—˜ ê°€ëŠ¥ì„±
```

#### ğŸ’­ tmpfs Mount
```
âœ… ë©”ëª¨ë¦¬ì—ë§Œ ì €ì¥ (ë¹ ë¦„)
âœ… ë¯¼ê°í•œ ì„ì‹œ ë°ì´í„°ìš©
âš ï¸ ì»¨í…Œì´ë„ˆ ì¢…ë£Œ ì‹œ ì‚­ì œ
âš ï¸ Linuxì—ì„œë§Œ ì‚¬ìš© ê°€ëŠ¥
```

## Volume ì‚¬ìš©ë²•

### ğŸ“ ê¸°ë³¸ ëª…ë ¹ì–´
```bash
# Volume ìƒì„±
docker volume create my-volume

# Volume ëª©ë¡ í™•ì¸
docker volume ls

# Volume ìƒì„¸ ì •ë³´
docker volume inspect my-volume

# Volume ì‚­ì œ
docker volume rm my-volume

# ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” Volume ì •ë¦¬
docker volume prune
```

### ğŸš€ ì»¨í…Œì´ë„ˆì—ì„œ Volume ì‚¬ìš©
```bash
# ëª…ëª…ëœ Volume ì‚¬ìš©
docker run -d -v my-volume:/data nginx

# ìµëª… Volume ì‚¬ìš© (Dockerê°€ ìë™ ìƒì„±)
docker run -d -v /data nginx

# ì½ê¸° ì „ìš© Volume
docker run -d -v my-volume:/data:ro nginx

# ì—¬ëŸ¬ Volume ë§ˆìš´íŠ¸
docker run -d \
  -v data-vol:/app/data \
  -v logs-vol:/app/logs \
  my-app
```

## ì‹¤ì „ ì˜ˆì‹œ

### ğŸ—„ï¸ MySQL ë°ì´í„°ë² ì´ìŠ¤
```bash
# MySQLìš© Volume ìƒì„±
docker volume create mysql-data

# MySQL ì»¨í…Œì´ë„ˆ ì‹¤í–‰ (ë°ì´í„° ì˜êµ¬ ë³´ì¡´)
docker run -d \
  --name mysql-db \
  -e MYSQL_ROOT_PASSWORD=password \
  -e MYSQL_DATABASE=myapp \
  -v mysql-data:/var/lib/mysql \
  -p 3306:3306 \
  mysql:8.0

# Volume í™•ì¸
docker volume inspect mysql-data

# ì»¨í…Œì´ë„ˆë¥¼ ì‚­ì œí•´ë„ ë°ì´í„°ëŠ” ë³´ì¡´ë¨!
docker rm -f mysql-db

# ìƒˆ ì»¨í…Œì´ë„ˆë¡œ ê°™ì€ ë°ì´í„° ì‚¬ìš©
docker run -d \
  --name mysql-db-new \
  -e MYSQL_ROOT_PASSWORD=password \
  -v mysql-data:/var/lib/mysql \
  mysql:8.0
```

### ğŸ“Š PostgreSQL ì˜ˆì‹œ
```bash
# PostgreSQL ë°ì´í„° ë³¼ë¥¨
docker volume create postgres-data

# PostgreSQL ì‹¤í–‰
docker run -d \
  --name postgres-db \
  -e POSTGRES_PASSWORD=password \
  -e POSTGRES_DB=myapp \
  -v postgres-data:/var/lib/postgresql/data \
  -p 5432:5432 \
  postgres:13

# ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…
docker exec postgres-db pg_dump -U postgres myapp > backup.sql
```

### ğŸ“ ë¡œê·¸ ìˆ˜ì§‘ ì˜ˆì‹œ
```bash
# ë¡œê·¸ Volume ìƒì„±
docker volume create app-logs

# ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆê°€ ê°™ì€ ë¡œê·¸ Volume ê³µìœ 
docker run -d --name web-app \
  -v app-logs:/app/logs \
  my-web-app

docker run -d --name log-processor \
  -v app-logs:/logs \
  log-analyzer
```

## Bind Mount ì‚¬ìš©ë²•

### ğŸ’» ê°œë°œ í™˜ê²½ ì„¤ì •
```bash
# í˜„ì¬ ë””ë ‰í† ë¦¬ë¥¼ ì»¨í…Œì´ë„ˆì— ë§ˆìš´íŠ¸
docker run -it \
  -v $(pwd):/workspace \
  -w /workspace \
  node:16 bash

# Windowsì—ì„œ
docker run -it \
  -v %cd%:/workspace \
  -w /workspace \
  node:16 bash

# íŠ¹ì • íŒŒì¼ë§Œ ë§ˆìš´íŠ¸
docker run -d \
  -v $(pwd)/nginx.conf:/etc/nginx/nginx.conf \
  nginx
```

### ğŸ”§ ì‹¤ì‹œê°„ ê°œë°œ
```bash
# React ê°œë°œ í™˜ê²½
docker run -it \
  --name react-dev \
  -p 3000:3000 \
  -v $(pwd):/app \
  -w /app \
  node:16 \
  npm start

# ì½”ë“œ ë³€ê²½ì´ ì‹¤ì‹œê°„ìœ¼ë¡œ ë°˜ì˜ë¨!
```

### ğŸ“‚ ì„¤ì • íŒŒì¼ ê³µìœ 
```bash
# Nginx ì„¤ì • ê³µìœ 
docker run -d \
  --name nginx-custom \
  -p 80:80 \
  -v $(pwd)/nginx.conf:/etc/nginx/nginx.conf:ro \
  -v $(pwd)/html:/usr/share/nginx/html \
  nginx

# ì½ê¸° ì „ìš©ìœ¼ë¡œ ë§ˆìš´íŠ¸í•˜ì—¬ ì•ˆì „ì„± í™•ë³´
```

## tmpfs Mount ì‚¬ìš©ë²•

### ğŸ’¾ ë©”ëª¨ë¦¬ ì €ì¥ì†Œ
```bash
# tmpfs ë§ˆìš´íŠ¸
docker run -d \
  --tmpfs /tmp \
  --tmpfs /run:rw,noexec,nosuid,size=100m \
  nginx

# ë¯¼ê°í•œ ë°ì´í„° ì„ì‹œ ì €ì¥
docker run -d \
  --tmpfs /secrets:noexec,nosuid,size=100m \
  my-secure-app
```

## Docker Composeì—ì„œ Volume ì‚¬ìš©

### ğŸ“„ ê¸°ë³¸ compose íŒŒì¼
```yaml
# docker-compose.yml
version: '3.8'

services:
  web:
    image: nginx
    ports:
      - "80:80"
    volumes:
      - web-content:/usr/share/nginx/html
      - ./nginx.conf:/etc/nginx/nginx.conf:ro
  
  database:
    image: mysql:8.0
    environment:
      MYSQL_ROOT_PASSWORD: password
      MYSQL_DATABASE: myapp
    volumes:
      - db-data:/var/lib/mysql
    
  redis:
    image: redis:alpine
    volumes:
      - redis-data:/data

volumes:
  web-content:
  db-data:
  redis-data:
```

### ğŸ”§ ê³ ê¸‰ Volume ì„¤ì •
```yaml
version: '3.8'

services:
  app:
    image: my-app
    volumes:
      # ëª…ëª…ëœ ë³¼ë¥¨
      - app-data:/app/data
      
      # Bind mount
      - ./src:/app/src
      
      # ìµëª… ë³¼ë¥¨
      - /app/tmp
      
      # ì™¸ë¶€ ë³¼ë¥¨
      - shared-data:/shared
      
      # tmpfs
      - type: tmpfs
        target: /app/cache
        tmpfs:
          size: 1000000000  # 1GB

volumes:
  app-data:
    driver: local
  shared-data:
    external: true  # ì™¸ë¶€ì—ì„œ ìƒì„±ëœ ë³¼ë¥¨
```

## Volume ë°±ì—…ê³¼ ë³µì›

### ğŸ’¾ ë°ì´í„° ë°±ì—…
```bash
# Volume ë°±ì—…
docker run --rm \
  -v mysql-data:/data \
  -v $(pwd):/backup \
  alpine tar czf /backup/mysql-backup.tar.gz /data

# íŠ¹ì • ì‹œì  ë°±ì—…
docker run --rm \
  -v mysql-data:/data \
  -v $(pwd):/backup \
  alpine sh -c "tar czf /backup/mysql-$(date +%Y%m%d).tar.gz /data"
```

### ğŸ“ ë°ì´í„° ë³µì›
```bash
# Volume ë³µì›
docker run --rm \
  -v mysql-data:/data \
  -v $(pwd):/backup \
  alpine tar xzf /backup/mysql-backup.tar.gz -C /

# ìƒˆ Volumeì— ë³µì›
docker volume create mysql-data-restored
docker run --rm \
  -v mysql-data-restored:/data \
  -v $(pwd):/backup \
  alpine tar xzf /backup/mysql-backup.tar.gz -C /
```

### ğŸ”„ Volume ë³µì‚¬
```bash
# Volume ê°„ ë°ì´í„° ë³µì‚¬
docker run --rm \
  -v source-volume:/source \
  -v target-volume:/target \
  alpine cp -a /source/. /target/
```

## ê³ ê¸‰ Volume ê´€ë¦¬

### ğŸ·ï¸ Volume ë¼ë²¨ê³¼ í•„í„°
```bash
# ë¼ë²¨ë¡œ Volume ìƒì„±
docker volume create \
  --label env=production \
  --label backup=daily \
  prod-data

# ë¼ë²¨ë¡œ Volume ê²€ìƒ‰
docker volume ls --filter label=env=production

# ë¼ë²¨ë¡œ Volume ì •ë¦¬
docker volume prune --filter label=env=development
```

### ğŸ“Š Volume ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§
```bash
# Volume í¬ê¸° í™•ì¸
docker system df -v

# íŠ¹ì • Volume í¬ê¸° ìƒì„¸ í™•ì¸
docker run --rm -v my-volume:/data alpine du -sh /data

# ëª¨ë“  Volume ì‚¬ìš©ëŸ‰ ì²´í¬
for vol in $(docker volume ls -q); do
  echo "Volume: $vol"
  docker run --rm -v $vol:/data alpine du -sh /data
done
```

### ğŸ”§ Volume ë“œë¼ì´ë²„
```bash
# ë¡œì»¬ ë“œë¼ì´ë²„ (ê¸°ë³¸)
docker volume create --driver local my-local-vol

# NFS Volume (ë„¤íŠ¸ì›Œí¬ ì €ì¥ì†Œ)
docker volume create \
  --driver local \
  --opt type=nfs \
  --opt o=addr=192.168.1.100,rw \
  --opt device=:/path/to/dir \
  nfs-volume

# í´ë¼ìš°ë“œ ì €ì¥ì†Œ (í”ŒëŸ¬ê·¸ì¸ í•„ìš”)
docker volume create \
  --driver rexray/ebs \
  --opt size=10 \
  aws-ebs-volume
```

## ì„±ëŠ¥ ìµœì í™”

### âš¡ Volume ì„±ëŠ¥ íŒ
```bash
# 1. SSD ì‚¬ìš© ê¶Œì¥
# 2. Volume ìœ„ì¹˜ ìµœì í™”
docker volume create \
  --opt type=none \
  --opt o=bind \
  --opt device=/fast/ssd/path \
  fast-volume

# 3. ë©”ëª¨ë¦¬ ìºì‹œ í™œìš©
docker run -d \
  --tmpfs /tmp:rw,size=1g \
  -v data-vol:/app/data \
  my-app

# 4. I/O ì œí•œ ì„¤ì •
docker run -d \
  --device-write-bps /dev/sda:1mb \
  --device-read-bps /dev/sda:1mb \
  -v my-vol:/data \
  my-app
```

### ğŸ“ˆ ì„±ëŠ¥ ì¸¡ì •
```bash
# Volume I/O ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
docker run --rm \
  -v test-vol:/data \
  alpine sh -c "
    echo 'ì“°ê¸° í…ŒìŠ¤íŠ¸:'
    time dd if=/dev/zero of=/data/testfile bs=1M count=100
    echo 'ì½ê¸° í…ŒìŠ¤íŠ¸:'
    time dd if=/data/testfile of=/dev/null bs=1M
    rm /data/testfile
  "
```

## ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜

### ğŸšš Volume ê°„ ë°ì´í„° ì´ë™
```bash
# 1. ì†ŒìŠ¤ ì»¨í…Œì´ë„ˆ ì¤‘ì§€
docker stop source-container

# 2. ìƒˆ Volumeìœ¼ë¡œ ë°ì´í„° ë³µì‚¬
docker run --rm \
  -v old-volume:/source \
  -v new-volume:/target \
  alpine sh -c "cp -a /source/. /target/"

# 3. ìƒˆ Volumeìœ¼ë¡œ ì»¨í…Œì´ë„ˆ ì‹œì‘
docker run -d \
  --name new-container \
  -v new-volume:/data \
  my-app
```

### ğŸŒ í˜¸ìŠ¤íŠ¸ ê°„ Volume ì´ë™
```bash
# 1. Volume ë°±ì—…
docker run --rm \
  -v source-vol:/data \
  -v $(pwd):/backup \
  alpine tar czf /backup/data.tar.gz /data

# 2. ë‹¤ë¥¸ í˜¸ìŠ¤íŠ¸ë¡œ íŒŒì¼ ì „ì†¡
scp data.tar.gz user@target-host:/tmp/

# 3. ëŒ€ìƒ í˜¸ìŠ¤íŠ¸ì—ì„œ Volume ìƒì„± ë° ë³µì›
ssh user@target-host "
  docker volume create target-vol
  docker run --rm \
    -v target-vol:/data \
    -v /tmp:/backup \
    alpine tar xzf /backup/data.tar.gz -C /
"
```

## ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### ğŸ”’ Volume ë³´ì•ˆ
```bash
# 1. ì½ê¸° ì „ìš© ë§ˆìš´íŠ¸
docker run -d -v config-vol:/config:ro my-app

# 2. íŠ¹ì • ì‚¬ìš©ì ê¶Œí•œ
docker run -d \
  --user 1000:1000 \
  -v user-data:/home/user \
  my-app

# 3. ë¯¼ê°í•œ ë°ì´í„°ëŠ” tmpfs ì‚¬ìš©
docker run -d \
  --tmpfs /tmp:noexec,nosuid,size=100m \
  secure-app

# 4. Volume ì•”í˜¸í™” (ì™¸ë¶€ ë„êµ¬ í•„ìš”)
docker run -d \
  -v encrypted-vol:/data \
  --security-opt apparmor:docker-default \
  my-app
```

### ğŸ›¡ï¸ ê¶Œí•œ ê´€ë¦¬
```bash
# Volume ìƒì„± ì‹œ ê¶Œí•œ ì„¤ì •
docker run --rm \
  -v new-vol:/data \
  alpine chown -R 1000:1000 /data

# ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ì‹œ ì‚¬ìš©ì ì§€ì •
docker run -d \
  --user 1000:1000 \
  -v app-data:/app/data \
  my-app
```

## ë¬¸ì œ í•´ê²°

### ğŸ› ì¼ë°˜ì ì¸ ë¬¸ì œë“¤

#### 1. Volume ë§ˆìš´íŠ¸ ì‹¤íŒ¨
```bash
# ë¬¸ì œ ì§„ë‹¨
docker logs container-name
docker inspect container-name

# Volume ì¡´ì¬ ì—¬ë¶€ í™•ì¸
docker volume ls
docker volume inspect volume-name

# ê¶Œí•œ ë¬¸ì œ í•´ê²°
docker exec -it container-name ls -la /mount/point
```

#### 2. ì„±ëŠ¥ ë¬¸ì œ
```bash
# I/O í†µê³„ í™•ì¸
docker stats container-name

# Volume ë“œë¼ì´ë²„ í™•ì¸
docker volume inspect volume-name

# ë””ìŠ¤í¬ ê³µê°„ í™•ì¸
docker system df
```

#### 3. ë°ì´í„° ì†ì‹¤ ë°©ì§€
```bash
# ì •ê¸° ë°±ì—… ìŠ¤í¬ë¦½íŠ¸
#!/bin/bash
DATE=$(date +%Y%m%d_%H%M%S)
docker run --rm \
  -v mysql-data:/data \
  -v /backup:/backup \
  alpine tar czf /backup/mysql_$DATE.tar.gz /data

# cronìœ¼ë¡œ ìë™í™”
# 0 2 * * * /path/to/backup-script.sh
```

## ëª¨ë²” ì‚¬ë¡€

### âœ… DO (í•´ì•¼ í•  ê²ƒë“¤)
```bash
# 1. ëª…ëª…ëœ Volume ì‚¬ìš©
docker volume create app-data
docker run -v app-data:/data my-app

# 2. ì •ê¸°ì ì¸ ë°±ì—…
# 3. Volume ë¼ë²¨ í™œìš©
# 4. ì½ê¸° ì „ìš© ë§ˆìš´íŠ¸ ì ê·¹ í™œìš©
# 5. ë¶ˆí•„ìš”í•œ Volume ì •ë¦¬
```

### âŒ DON'T (í•˜ì§€ ë§ì•„ì•¼ í•  ê²ƒë“¤)
```bash
# 1. ì¤‘ìš”í•œ ë°ì´í„°ë¥¼ ì»¨í…Œì´ë„ˆì—ë§Œ ì €ì¥
# 2. ìµëª… Volume ë‚¨ë°œ
# 3. ë°±ì—… ì—†ì´ ìš´ì˜
# 4. ë£¨íŠ¸ ê¶Œí•œìœ¼ë¡œ ëª¨ë“  Volume ì ‘ê·¼
# 5. Volume ì •ë¦¬ë¥¼ í•˜ì§€ ì•ŠìŒ
```

## ë‹¤ìŒ ë‹¨ê³„

### ğŸ“ í•™ìŠµ ìˆœì„œ
Volumeì„ ë§ˆìŠ¤í„°í–ˆë‹¤ë©´:
1. **[[Docker Networking]]** - ì»¨í…Œì´ë„ˆ ê°„ í†µì‹ í•˜ê¸°
2. **[[Docker Compose]]** - ë³µì¡í•œ í™˜ê²½ êµ¬ì„±í•˜ê¸°
3. **[[Docker ì‹¤ìŠµ ê°€ì´ë“œ]]** - ì‹¤ì „ í”„ë¡œì íŠ¸ ì§„í–‰

### ğŸ’¡ ì‹¤ìŠµ ì¶”ì²œ
```bash
# ì˜¤ëŠ˜ í•´ë³¼ ì‹¤ìŠµ
1. MySQL ì»¨í…Œì´ë„ˆë¡œ Volume ì—°ìŠµ
2. ê°œë°œ í™˜ê²½ì—ì„œ Bind Mount í™œìš©
3. Volume ë°±ì—…ê³¼ ë³µì› ì‹¤ìŠµ
4. Docker Composeë¡œ ë‹¤ì¤‘ Volume ê´€ë¦¬
```

Volumeê³¼ Storageë¥¼ ë§ˆìŠ¤í„°í–ˆë‹¤ë©´ [[Docker Networking]]ìœ¼ë¡œ ì»¨í…Œì´ë„ˆ ê°„ í†µì‹ ì„ ë°°ì›Œë³´ì„¸ìš”!

#Docker #Volume #Storage #ë°ì´í„°ê´€ë¦¬ #ë°±ì—…
