
# Docker Networking

## ğŸŒ Docker ë„¤íŠ¸ì›Œí‚¹ì´ë€?

### ğŸ“ ì „í™” í†µì‹  ë¹„ìœ 
```
ğŸ  ì»¨í…Œì´ë„ˆ = ì§‘
ğŸ“ ë„¤íŠ¸ì›Œí¬ = ì „í™”ì„ 
ğŸ“‹ IP ì£¼ì†Œ = ì „í™”ë²ˆí˜¸
ğŸŒ Docker ë„¤íŠ¸ì›Œí¬ = ì „í™” êµí™˜ì†Œ

ë¬¸ì œ: ì»¨í…Œì´ë„ˆë“¤ì´ ì„œë¡œ ì–´ë–»ê²Œ ëŒ€í™”í• ê¹Œ?
í•´ê²°: Dockerê°€ ê°€ìƒì˜ ì „í™” êµí™˜ì†Œ ì—­í• ! ğŸ“
```

### ğŸ˜ï¸ ì•„íŒŒíŠ¸ ë‹¨ì§€ ë¹„ìœ 
```
ğŸ¢ Docker Host = ì•„íŒŒíŠ¸ ë‹¨ì§€
ğŸ  ì»¨í…Œì´ë„ˆ = ê° ì„¸ëŒ€
ğŸ›£ï¸ ë„¤íŠ¸ì›Œí¬ = ë‹¨ì§€ ë‚´ ë„ë¡œë§
ğŸšª í¬íŠ¸ = ì§‘ ë¬¸ ë²ˆí˜¸
ğŸ“¬ íŒ¨í‚· = íƒë°°

ê°™ì€ ë„ë¡œ(ë„¤íŠ¸ì›Œí¬)ì— ìˆìœ¼ë©´ ì‰½ê²Œ ë°©ë¬¸ ê°€ëŠ¥!
ë‹¤ë¥¸ ë„ë¡œì— ìˆìœ¼ë©´ êµì°¨ë¡œ(ë¼ìš°íŒ…) í•„ìš”!
```

## Docker ë„¤íŠ¸ì›Œí¬ ì¢…ë¥˜

### ğŸ“Š ë„¤íŠ¸ì›Œí¬ ë“œë¼ì´ë²„ ë¹„êµ
| ë“œë¼ì´ë²„ | ë²”ìœ„ | ì‚¬ìš© ì‚¬ë¡€ | ê²©ë¦¬ ìˆ˜ì¤€ |
|----------|------|-----------|-----------|
| **bridge** | ë‹¨ì¼ í˜¸ìŠ¤íŠ¸ | ê¸°ë³¸ ì»¨í…Œì´ë„ˆ í†µì‹  | ë†’ìŒ |
| **host** | ë‹¨ì¼ í˜¸ìŠ¤íŠ¸ | ìµœê³  ì„±ëŠ¥ í•„ìš” ì‹œ | ì—†ìŒ |
| **overlay** | ë‹¤ì¤‘ í˜¸ìŠ¤íŠ¸ | Docker Swarm | ë†’ìŒ |
| **macvlan** | ë‹¨ì¼ í˜¸ìŠ¤íŠ¸ | ë ˆê±°ì‹œ ì—°ë™ | ë§¤ìš° ë†’ìŒ |
| **none** | ì—†ìŒ | ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬ | ì™„ì „ |

### ğŸŒ‰ bridge ë„¤íŠ¸ì›Œí¬ (ê¸°ë³¸ê°’)
```
íŠ¹ì§•:
âœ… Docker ê¸°ë³¸ ë„¤íŠ¸ì›Œí¬
âœ… ê°€ìƒ ë¸Œë¦¬ì§€ë¥¼ í†µí•œ í†µì‹ 
âœ… NATë¡œ ì™¸ë¶€ í†µì‹ 
âœ… ì»¨í…Œì´ë„ˆ ê°„ ê²©ë¦¬

ì‚¬ìš© ì˜ˆì‹œ:
- ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜
- ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤
- ê°œë°œ í™˜ê²½
```

### ğŸƒ host ë„¤íŠ¸ì›Œí¬
```
íŠ¹ì§•:
âœ… í˜¸ìŠ¤íŠ¸ ë„¤íŠ¸ì›Œí¬ ì§ì ‘ ì‚¬ìš©
âœ… ìµœê³  ì„±ëŠ¥
âš ï¸ í¬íŠ¸ ì¶©ëŒ ì£¼ì˜
âš ï¸ ë³´ì•ˆ ìœ„í—˜

ì‚¬ìš© ì˜ˆì‹œ:
- ê³ ì„±ëŠ¥ ë„¤íŠ¸ì›Œí¬ ì• í”Œë¦¬ì¼€ì´ì…˜
- ëª¨ë‹ˆí„°ë§ ë„êµ¬
- ë„¤íŠ¸ì›Œí¬ ìŠ¤ìº” ë„êµ¬
```

### ğŸ”— overlay ë„¤íŠ¸ì›Œí¬
```
íŠ¹ì§•:
âœ… ì—¬ëŸ¬ Docker í˜¸ìŠ¤íŠ¸ ì—°ê²°
âœ… Docker Swarmì—ì„œ ì£¼ë¡œ ì‚¬ìš©
âœ… ì•”í˜¸í™” ì§€ì›
âœ… ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬

ì‚¬ìš© ì˜ˆì‹œ:
- í´ëŸ¬ìŠ¤í„° í™˜ê²½
- ë¶„ì‚° ì• í”Œë¦¬ì¼€ì´ì…˜
- ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜
```

## ê¸°ë³¸ ë„¤íŠ¸ì›Œí¬ ëª…ë ¹ì–´

### ğŸ” ë„¤íŠ¸ì›Œí¬ í™•ì¸
```bash
# ë„¤íŠ¸ì›Œí¬ ëª©ë¡ ë³´ê¸°
docker network ls

# ë„¤íŠ¸ì›Œí¬ ìƒì„¸ ì •ë³´
docker network inspect bridge
docker network inspect my-network

# ì»¨í…Œì´ë„ˆì˜ ë„¤íŠ¸ì›Œí¬ ì •ë³´
docker inspect container-name | grep -A 20 "NetworkSettings"
```

### ğŸ› ï¸ ë„¤íŠ¸ì›Œí¬ ìƒì„±ê³¼ ì‚­ì œ
```bash
# ê¸°ë³¸ bridge ë„¤íŠ¸ì›Œí¬ ìƒì„±
docker network create my-network

# íŠ¹ì • ë“œë¼ì´ë²„ë¡œ ë„¤íŠ¸ì›Œí¬ ìƒì„±
docker network create --driver bridge my-bridge
docker network create --driver overlay my-overlay

# ì„œë¸Œë„· ì§€ì •
docker network create \
  --subnet=172.20.0.0/16 \
  --ip-range=172.20.240.0/20 \
  my-custom-network

# ë„¤íŠ¸ì›Œí¬ ì‚­ì œ
docker network rm my-network

# ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë„¤íŠ¸ì›Œí¬ ì •ë¦¬
docker network prune
```

### ğŸ”Œ ì»¨í…Œì´ë„ˆ ë„¤íŠ¸ì›Œí¬ ì—°ê²°
```bash
# ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ì‹œ ë„¤íŠ¸ì›Œí¬ ì§€ì •
docker run -d --network my-network --name web nginx

# ì‹¤í–‰ ì¤‘ì¸ ì»¨í…Œì´ë„ˆë¥¼ ë„¤íŠ¸ì›Œí¬ì— ì—°ê²°
docker network connect my-network existing-container

# ë„¤íŠ¸ì›Œí¬ì—ì„œ ì»¨í…Œì´ë„ˆ ë¶„ë¦¬
docker network disconnect my-network container-name

# ì—¬ëŸ¬ ë„¤íŠ¸ì›Œí¬ì— ì—°ê²°
docker network connect network1 my-container
docker network connect network2 my-container
```

## í¬íŠ¸ ë§¤í•‘ê³¼ ë…¸ì¶œ

### ğŸšª í¬íŠ¸ ë§¤í•‘ ê¸°ë³¸
```bash
# ê¸°ë³¸ í¬íŠ¸ ë§¤í•‘
docker run -d -p 8080:80 nginx

# íŠ¹ì • ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ë°”ì¸ë”©
docker run -d -p 127.0.0.1:8080:80 nginx

# ì—¬ëŸ¬ í¬íŠ¸ ë§¤í•‘
docker run -d \
  -p 80:80 \
  -p 443:443 \
  nginx

# ë™ì  í¬íŠ¸ í• ë‹¹
docker run -d -p 80 nginx  # Dockerê°€ ìë™ìœ¼ë¡œ í˜¸ìŠ¤íŠ¸ í¬íŠ¸ í• ë‹¹

# UDP í¬íŠ¸ ë§¤í•‘
docker run -d -p 53:53/udp dns-server
```

### ğŸ“‹ í¬íŠ¸ í™•ì¸
```bash
# ì»¨í…Œì´ë„ˆ í¬íŠ¸ ë§¤í•‘ í™•ì¸
docker port container-name

# ì‹¤í–‰ ì¤‘ì¸ ì»¨í…Œì´ë„ˆì˜ í¬íŠ¸ í™•ì¸
docker ps

# ìƒì„¸ í¬íŠ¸ ì •ë³´
docker inspect container-name | grep -A 10 "Ports"
```

### ğŸ” EXPOSE vs -p ì°¨ì´ì 
```dockerfile
# Dockerfileì—ì„œ EXPOSE (ë¬¸ì„œí™” ëª©ì )
FROM nginx
EXPOSE 80 443

# ì‹¤ì œ í¬íŠ¸ ê°œë°©ì€ -p ì˜µì…˜ìœ¼ë¡œ
docker run -d -p 8080:80 my-nginx
```

## ì»¨í…Œì´ë„ˆ ê°„ í†µì‹ 

### ğŸ  ê°™ì€ ë„¤íŠ¸ì›Œí¬ ë‚´ í†µì‹ 
```bash
# ì»¤ìŠ¤í…€ ë„¤íŠ¸ì›Œí¬ ìƒì„±
docker network create webapp-network

# ë°ì´í„°ë² ì´ìŠ¤ ì»¨í…Œì´ë„ˆ ì‹¤í–‰
docker run -d \
  --network webapp-network \
  --name database \
  -e MYSQL_ROOT_PASSWORD=password \
  mysql:8.0

# ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…Œì´ë„ˆ ì‹¤í–‰
docker run -d \
  --network webapp-network \
  --name webapp \
  -p 8080:3000 \
  -e DB_HOST=database \
  my-webapp:latest

# webappì—ì„œ databaseë¡œ ì ‘ê·¼ ê°€ëŠ¥!
# mysql -h database -u root -p
```

### ğŸ”— ì»¨í…Œì´ë„ˆ ì´ë¦„ìœ¼ë¡œ í†µì‹ 
```bash
# ê°™ì€ ë„¤íŠ¸ì›Œí¬ì˜ ì»¨í…Œì´ë„ˆëŠ” ì´ë¦„ìœ¼ë¡œ ì ‘ê·¼ ê°€ëŠ¥
docker exec webapp ping database
docker exec webapp curl http://api-server:3000/health

# /etc/hosts í™•ì¸
docker exec webapp cat /etc/hosts
```

### ğŸŒ ì™¸ë¶€ ë„¤íŠ¸ì›Œí¬ í†µì‹ 
```bash
# ì™¸ë¶€ ì¸í„°ë„· ì ‘ê·¼ (ê¸°ë³¸ì ìœ¼ë¡œ ê°€ëŠ¥)
docker exec webapp curl https://google.com

# DNS ì„¤ì •
docker run -d \
  --dns=8.8.8.8 \
  --dns=8.8.4.4 \
  my-app

# hosts íŒŒì¼ ì¶”ê°€
docker run -d \
  --add-host=myapi.local:192.168.1.100 \
  my-app
```

## ì‹¤ì „ ì˜ˆì‹œ

### ğŸŒ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ìŠ¤íƒ
```bash
# 1. ë„¤íŠ¸ì›Œí¬ ìƒì„±
docker network create web-tier
docker network create db-tier

# 2. ë°ì´í„°ë² ì´ìŠ¤ (ë°±ì—”ë“œ ë„¤íŠ¸ì›Œí¬ë§Œ)
docker run -d \
  --name postgres \
  --network db-tier \
  -e POSTGRES_PASSWORD=password \
  -e POSTGRES_DB=myapp \
  postgres:13

# 3. ë°±ì—”ë“œ API (ë‘ ë„¤íŠ¸ì›Œí¬ ëª¨ë‘)
docker run -d \
  --name api-server \
  --network db-tier \
  -e DB_HOST=postgres \
  my-api:latest

docker network connect web-tier api-server

# 4. í”„ë¡ íŠ¸ì—”ë“œ (ì›¹ ë„¤íŠ¸ì›Œí¬ë§Œ)
docker run -d \
  --name frontend \
  --network web-tier \
  -p 80:80 \
  -e API_URL=http://api-server:3000 \
  my-frontend:latest

# 5. ë¡œë“œ ë°¸ëŸ°ì„œ
docker run -d \
  --name nginx-lb \
  --network web-tier \
  -p 8080:80 \
  -v $(pwd)/nginx.conf:/etc/nginx/nginx.conf \
  nginx
```

### ğŸ”„ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ í†µì‹ 
```bash
# ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ë„¤íŠ¸ì›Œí¬
docker network create microservices

# ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ìš© Consul
docker run -d \
  --name consul \
  --network microservices \
  -p 8500:8500 \
  consul

# ì‚¬ìš©ì ì„œë¹„ìŠ¤
docker run -d \
  --name user-service \
  --network microservices \
  -e CONSUL_HOST=consul \
  user-service:latest

# ì£¼ë¬¸ ì„œë¹„ìŠ¤
docker run -d \
  --name order-service \
  --network microservices \
  -e CONSUL_HOST=consul \
  -e USER_SERVICE_URL=http://user-service:3000 \
  order-service:latest

# API ê²Œì´íŠ¸ì›¨ì´
docker run -d \
  --name api-gateway \
  --network microservices \
  -p 80:8080 \
  -e USER_SERVICE=user-service:3000 \
  -e ORDER_SERVICE=order-service:3000 \
  api-gateway:latest
```

### ğŸ“Š ëª¨ë‹ˆí„°ë§ ìŠ¤íƒ
```bash
# ëª¨ë‹ˆí„°ë§ ë„¤íŠ¸ì›Œí¬
docker network create monitoring

# Prometheus
docker run -d \
  --name prometheus \
  --network monitoring \
  -p 9090:9090 \
  -v $(pwd)/prometheus.yml:/etc/prometheus/prometheus.yml \
  prom/prometheus

# Grafana
docker run -d \
  --name grafana \
  --network monitoring \
  -p 3000:3000 \
  -e GF_SECURITY_ADMIN_PASSWORD=admin \
  grafana/grafana

# Node Exporter
docker run -d \
  --name node-exporter \
  --network monitoring \
  --pid host \
  -v /:/host:ro,rslave \
  prom/node-exporter --path.rootfs=/host
```

## Docker Composeì—ì„œ ë„¤íŠ¸ì›Œí‚¹

### ğŸ“„ ê¸°ë³¸ ë„¤íŠ¸ì›Œí¬ ì„¤ì •
```yaml
# docker-compose.yml
version: '3.8'

services:
  web:
    image: nginx
    ports:
      - "80:80"
    depends_on:
      - api
  
  api:
    image: my-api
    environment:
      - DB_HOST=database
    depends_on:
      - database
  
  database:
    image: postgres:13
    environment:
      - POSTGRES_PASSWORD=password

# Docker Composeê°€ ìë™ìœ¼ë¡œ ë„¤íŠ¸ì›Œí¬ ìƒì„±
# ëª¨ë“  ì„œë¹„ìŠ¤ê°€ ê°™ì€ ë„¤íŠ¸ì›Œí¬ì— ì†í•¨
# ì„œë¹„ìŠ¤ ì´ë¦„ìœ¼ë¡œ ì„œë¡œ ì ‘ê·¼ ê°€ëŠ¥
```

### ğŸ—ï¸ ì»¤ìŠ¤í…€ ë„¤íŠ¸ì›Œí¬ ì„¤ì •
```yaml
version: '3.8'

services:
  frontend:
    image: my-frontend
    networks:
      - web-tier
    ports:
      - "80:80"
  
  backend:
    image: my-backend
    networks:
      - web-tier
      - db-tier
    environment:
      - DB_HOST=database
  
  database:
    image: postgres:13
    networks:
      - db-tier
    environment:
      - POSTGRES_PASSWORD=password

networks:
  web-tier:
    driver: bridge
  db-tier:
    driver: bridge
    internal: true  # ì™¸ë¶€ ì ‘ê·¼ ì°¨ë‹¨
```

### ğŸ”§ ê³ ê¸‰ ë„¤íŠ¸ì›Œí¬ ì„¤ì •
```yaml
version: '3.8'

services:
  web:
    image: nginx
    networks:
      frontend:
        ipv4_address: 172.20.0.10
      backend:
        aliases:
          - web-server
          - nginx-server
    ports:
      - "80:80"
      - target: 443
        published: 8443
        protocol: tcp

networks:
  frontend:
    driver: bridge
    ipam:
      driver: default
      config:
        - subnet: 172.20.0.0/16
          ip_range: 172.20.5.0/24
          gateway: 172.20.0.1
  
  backend:
    driver: overlay
    driver_opts:
      encrypted: "true"
    external: true
```

## ê³ ê¸‰ ë„¤íŠ¸ì›Œí‚¹

### ğŸ”’ ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ
```bash
# ë‚´ë¶€ ì „ìš© ë„¤íŠ¸ì›Œí¬ (ì™¸ë¶€ ì ‘ê·¼ ì°¨ë‹¨)
docker network create \
  --internal \
  --subnet=172.30.0.0/16 \
  internal-network

# ì•”í˜¸í™”ëœ ì˜¤ë²„ë ˆì´ ë„¤íŠ¸ì›Œí¬
docker network create \
  --driver overlay \
  --opt encrypted \
  secure-overlay

# ë°©í™”ë²½ ê·œì¹™ê³¼ í•¨ê»˜ ì‚¬ìš©
iptables -A INPUT -i docker0 -j ACCEPT
iptables -A FORWARD -i docker0 -j ACCEPT
```

### ğŸŒ ë©€í‹° í˜¸ìŠ¤íŠ¸ ë„¤íŠ¸ì›Œí‚¹
```bash
# Docker Swarm ì´ˆê¸°í™”
docker swarm init --advertise-addr 192.168.1.100

# ì˜¤ë²„ë ˆì´ ë„¤íŠ¸ì›Œí¬ ìƒì„±
docker network create \
  --driver overlay \
  --attachable \
  multi-host-network

# ë‹¤ë¥¸ ë…¸ë“œì—ì„œ ë„¤íŠ¸ì›Œí¬ ì‚¬ìš©
docker run -d \
  --network multi-host-network \
  --name web1 \
  nginx

# ì²« ë²ˆì§¸ ë…¸ë“œì—ì„œë„ ê°™ì€ ë„¤íŠ¸ì›Œí¬ ì‚¬ìš©
docker run -d \
  --network multi-host-network \
  --name web2 \
  nginx
```

### ğŸ”— ì™¸ë¶€ ë„¤íŠ¸ì›Œí¬ ì—°ê²°
```bash
# ê¸°ì¡´ ë„¤íŠ¸ì›Œí¬ ì‚¬ìš©
docker network create \
  --driver bridge \
  --subnet=192.168.100.0/24 \
  --gateway=192.168.100.1 \
  existing-network

# ì™¸ë¶€ ìƒì„±ëœ ë„¤íŠ¸ì›Œí¬ ì‚¬ìš©
docker run -d \
  --network existing-network \
  --ip 192.168.100.10 \
  my-app
```

## ë„¤íŠ¸ì›Œí¬ ì„±ëŠ¥ ìµœì í™”

### âš¡ ì„±ëŠ¥ í–¥ìƒ íŒ
```bash
# 1. host ë„¤íŠ¸ì›Œí¬ ì‚¬ìš© (ìµœê³  ì„±ëŠ¥)
docker run -d --network host high-performance-app

# 2. SR-IOV í™œìš© (í•˜ë“œì›¨ì–´ ì§€ì› í•„ìš”)
docker run -d \
  --network=sriov \
  --device=/dev/vfio/0 \
  network-intensive-app

# 3. ëŒ€ì—­í­ ì œí•œ
docker run -d \
  --network my-network \
  --network-alias web \
  --cap-add NET_ADMIN \
  nginx

# 4. ë„¤íŠ¸ì›Œí¬ ë²„í¼ íŠœë‹
echo 'net.core.rmem_max = 16777216' >> /etc/sysctl.conf
echo 'net.core.wmem_max = 16777216' >> /etc/sysctl.conf
```

### ğŸ“Š ë„¤íŠ¸ì›Œí¬ ëª¨ë‹ˆí„°ë§
```bash
# ë„¤íŠ¸ì›Œí¬ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§
docker stats --format "table {{.Container}}\t{{.NetIO}}"

# ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ í™•ì¸
docker exec container-name ip addr show

# ë„¤íŠ¸ì›Œí¬ ì—°ê²° ìƒíƒœ
docker exec container-name netstat -tulpn

# íŒ¨í‚· ìº¡ì²˜
docker exec container-name tcpdump -i eth0
```

## ë¡œë“œ ë°¸ëŸ°ì‹±

### âš–ï¸ Nginx ë¡œë“œ ë°¸ëŸ°ì„œ
```bash
# nginx.conf
upstream backend {
    server web1:80;
    server web2:80;
    server web3:80;
}

server {
    listen 80;
    location / {
        proxy_pass http://backend;
    }
}

# ë¡œë“œ ë°¸ëŸ°ì„œ ì‹¤í–‰
docker run -d \
  --name nginx-lb \
  --network web-network \
  -p 80:80 \
  -v $(pwd)/nginx.conf:/etc/nginx/nginx.conf \
  nginx
```

### ğŸ”„ HAProxy ë¡œë“œ ë°¸ëŸ°ì„œ
```bash
# haproxy.cfg
global
    daemon

defaults
    mode http
    timeout connect 5000ms
    timeout client 50000ms
    timeout server 50000ms

frontend web_frontend
    bind *:80
    default_backend web_servers

backend web_servers
    balance roundrobin
    server web1 web1:80 check
    server web2 web2:80 check

# HAProxy ì‹¤í–‰
docker run -d \
  --name haproxy-lb \
  --network web-network \
  -p 80:80 \
  -v $(pwd)/haproxy.cfg:/usr/local/etc/haproxy/haproxy.cfg \
  haproxy:alpine
```

## ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬

### ğŸ” DNS ê¸°ë°˜ ë””ìŠ¤ì»¤ë²„ë¦¬
```bash
# Docker ë‚´ì¥ DNS ì‚¬ìš©
docker run -d \
  --name web1 \
  --network my-network \
  --network-alias web \
  nginx

docker run -d \
  --name web2 \
  --network my-network \
  --network-alias web \
  nginx

# í´ë¼ì´ì–¸íŠ¸ì—ì„œ 'web'ìœ¼ë¡œ ì ‘ê·¼ ì‹œ ë¼ìš´ë“œ ë¡œë¹ˆ
docker run -it \
  --network my-network \
  alpine nslookup web
```

### ğŸ—‚ï¸ Consul ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬
```yaml
# docker-compose.yml
version: '3.8'

services:
  consul:
    image: consul
    ports:
      - "8500:8500"
    environment:
      - CONSUL_BIND_INTERFACE=eth0

  web:
    image: my-web-app
    environment:
      - CONSUL_HOST=consul
      - SERVICE_NAME=web
      - SERVICE_PORT=80
    depends_on:
      - consul
    deploy:
      replicas: 3

  registrator:
    image: gliderlabs/registrator
    volumes:
      - /var/run/docker.sock:/tmp/docker.sock
    command: -internal consul://consul:8500
```

## ë¬¸ì œ í•´ê²°

### ğŸ› ì¼ë°˜ì ì¸ ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ

#### 1. ì»¨í…Œì´ë„ˆ ê°„ í†µì‹  ì‹¤íŒ¨
```bash
# ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸
docker network ls
docker network inspect my-network

# ì»¨í…Œì´ë„ˆ ë„¤íŠ¸ì›Œí¬ ìƒíƒœ í™•ì¸
docker exec container1 ping container2
docker exec container1 nslookup container2

# ë°©í™”ë²½ ê·œì¹™ í™•ì¸
iptables -L DOCKER-USER
```

#### 2. í¬íŠ¸ ë°”ì¸ë”© ì‹¤íŒ¨
```bash
# í¬íŠ¸ ì‚¬ìš© ì¤‘ í™•ì¸
lsof -i :8080  # Linux/Mac
netstat -ano | findstr :8080  # Windows

# Docker í¬íŠ¸ ë°”ì¸ë”© í™•ì¸
docker port container-name
ss -tulpn | grep :8080
```

#### 3. DNS í•´ì„ ì‹¤íŒ¨
```bash
# DNS ì„¤ì • í™•ì¸
docker exec container cat /etc/resolv.conf

# ì»¤ìŠ¤í…€ DNS ì‚¬ìš©
docker run -d --dns=8.8.8.8 my-app

# hosts íŒŒì¼ í™•ì¸
docker exec container cat /etc/hosts
```

#### 4. ë„¤íŠ¸ì›Œí¬ ì„±ëŠ¥ ë¬¸ì œ
```bash
# ë„¤íŠ¸ì›Œí¬ ì§€ì—° ì‹œê°„ ì¸¡ì •
docker exec container1 ping -c 10 container2

# ëŒ€ì—­í­ í…ŒìŠ¤íŠ¸
docker run --rm -it --network my-network alpine \
  wget -O /dev/null http://container2/bigfile

# MTU í¬ê¸° í™•ì¸
docker exec container ip link show eth0
```

## ë³´ì•ˆ ëª¨ë²” ì‚¬ë¡€

### ğŸ”’ ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ
```bash
# 1. ìµœì†Œ ê¶Œí•œ ì›ì¹™
# í•„ìš”í•œ í¬íŠ¸ë§Œ ë…¸ì¶œ
docker run -d -p 127.0.0.1:3000:3000 my-app

# 2. ë„¤íŠ¸ì›Œí¬ ë¶„í• 
# ì›¹/ì•±/DB ê³„ì¸µë³„ ë„¤íŠ¸ì›Œí¬ ë¶„ë¦¬
docker network create web-tier
docker network create app-tier  
docker network create db-tier

# 3. ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ ì‚¬ìš©
docker network create --internal secure-network

# 4. ì•”í˜¸í™” ì‚¬ìš©
docker network create --opt encrypted overlay-network
```

### ğŸ›¡ï¸ ë°©í™”ë²½ ì„¤ì •
```bash
# Docker ì²´ì¸ ì‚¬ìš©ì ì •ì˜
iptables -I DOCKER-USER -s 192.168.1.0/24 -j ACCEPT
iptables -I DOCKER-USER -j DROP

# íŠ¹ì • í¬íŠ¸ë§Œ í—ˆìš©
iptables -I DOCKER-USER -p tcp --dport 80 -j ACCEPT
iptables -I DOCKER-USER -p tcp --dport 443 -j ACCEPT
```

## ëª¨ë²” ì‚¬ë¡€

### âœ… DO (í•´ì•¼ í•  ê²ƒë“¤)
```bash
# 1. ì»¤ìŠ¤í…€ ë„¤íŠ¸ì›Œí¬ ì‚¬ìš©
docker network create my-app-network

# 2. ì„œë¹„ìŠ¤ë³„ ë„¤íŠ¸ì›Œí¬ ë¶„ë¦¬
# 3. ì»¨í…Œì´ë„ˆ ì´ë¦„ìœ¼ë¡œ í†µì‹ 
# 4. ë¶ˆí•„ìš”í•œ í¬íŠ¸ ë…¸ì¶œ ê¸ˆì§€
# 5. ë„¤íŠ¸ì›Œí¬ ë³„ì¹­ í™œìš©
docker run --network-alias api my-service
```

### âŒ DON'T (í•˜ì§€ ë§ì•„ì•¼ í•  ê²ƒë“¤)
```bash
# 1. ê¸°ë³¸ bridge ë„¤íŠ¸ì›Œí¬ ì‚¬ìš© ê¸ˆì§€ (production)
# 2. --link ì˜µì…˜ ì‚¬ìš© ê¸ˆì§€ (deprecated)
# 3. ëª¨ë“  í¬íŠ¸ë¥¼ 0.0.0.0ì— ë°”ì¸ë”© ê¸ˆì§€
# 4. ë„¤íŠ¸ì›Œí¬ ë¶„í•  ì—†ì´ ëª¨ë“  ì„œë¹„ìŠ¤ ì—°ê²° ê¸ˆì§€
# 5. hard-coded IP ì£¼ì†Œ ì‚¬ìš© ê¸ˆì§€
```

## ë‹¤ìŒ ë‹¨ê³„

### ğŸ“ í•™ìŠµ ìˆœì„œ
Docker Networkingì„ ë§ˆìŠ¤í„°í–ˆë‹¤ë©´:
1. **[[Docker Compose]]** - ë³µì¡í•œ í™˜ê²½ êµ¬ì„±í•˜ê¸°
2. **[[Docker ì‹¤ìŠµ ê°€ì´ë“œ]]** - ì‹¤ì „ í”„ë¡œì íŠ¸ ì§„í–‰
3. **[[Kubernetes í•™ìŠµ ê°€ì´ë“œ]]** - ì»¨í…Œì´ë„ˆ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜

### ğŸ’¡ ì‹¤ìŠµ ì¶”ì²œ
```bash
# ì˜¤ëŠ˜ í•´ë³¼ ì‹¤ìŠµ
1. ì›¹-DB 2ê³„ì¸µ ì• í”Œë¦¬ì¼€ì´ì…˜ ë„¤íŠ¸ì›Œí¬ êµ¬ì„±
2. ë¡œë“œ ë°¸ëŸ°ì„œë¥¼ í†µí•œ ë‹¤ì¤‘ ì›¹ì„œë²„ ì—°ê²°
3. ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ê°„ í†µì‹  ì‹¤ìŠµ
4. Docker Composeë¡œ ë³µì¡í•œ ë„¤íŠ¸ì›Œí¬ í™˜ê²½ êµ¬ì„±
```

Docker Networkingì„ ë§ˆìŠ¤í„°í–ˆë‹¤ë©´ [[Docker Compose]]ë¡œ ë” ë³µì¡í•œ í™˜ê²½ì„ êµ¬ì„±í•´ë³´ì„¸ìš”!

#Docker #Networking #ì»¨í…Œì´ë„ˆí†µì‹  #ë„¤íŠ¸ì›Œí¬ #ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤
